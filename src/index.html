<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brew Detective - Resuelve el Misterio del Café</title>
    <link rel="stylesheet" href="css/main.css">
</head>
<body>
    <!-- Header -->
    <header>
        <nav class="container">
            <a href="/" class="logo">🔍 Brew Detective</a>
            <ul class="nav-links">
                <li><a href="/home">Inicio</a></li>
                <li><a href="/order">Ordenar Caja</a></li>
                <li id="submitMenuItem" class="nav-hidden"><a href="/submit">Enviar Respuestas</a></li>
                <li><a href="/leaderboard">Ranking</a></li>
                <li class="auth-nav" id="authNav">
                    <a href="#" onclick="Auth.login()" id="loginBtn">Iniciar Sesión</a>
                    <div class="user-dropdown hidden" id="userDropdown">
                        <a href="#" class="user-menu-toggle" id="userMenuToggle" onclick="toggleUserMenu()">
                            <img id="userAvatar" src="" alt="User Avatar" class="user-avatar">
                            <span id="userName">Usuario</span>
                            <span class="dropdown-arrow">▼</span>
                        </a>
                        <div class="user-menu" id="userMenu">
                            <a href="/profile" onclick="closeUserMenu()">Mi Perfil</a>
                            <a href="/admin" onclick="closeUserMenu()" id="adminMenuItem" class="nav-hidden">Administración</a>
                            <a href="#" onclick="Auth.logout()">Cerrar Sesión</a>
                        </div>
                    </div>
                </li>
            </ul>
            <div class="mobile-menu-toggle" onclick="toggleMobileMenu()">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </nav>
        <div class="mobile-nav" id="mobileNav">
            <button class="mobile-close" onclick="closeMobileMenu()">&times;</button>
            <ul>
                <li><a href="/home" onclick="closeMobileMenu()">Inicio</a></li>
                <li><a href="/order" onclick="closeMobileMenu()">Ordenar Caja</a></li>
                <li id="submitMenuItemMobile" class="nav-hidden"><a href="/submit" onclick="closeMobileMenu()">Enviar Respuestas</a></li>
                <li><a href="/leaderboard" onclick="closeMobileMenu()">Ranking</a></li>
                <li class="auth-nav-mobile" id="authNavMobile">
                    <a href="#" onclick="Auth.login(); closeMobileMenu()" id="loginBtnMobile">Iniciar Sesión</a>
                    <div class="user-dropdown-mobile hidden" id="userDropdownMobile">
                        <a href="/profile" onclick="closeMobileMenu()" id="profileBtnMobile">Mi Perfil</a>
                        <a href="#" onclick="Auth.logout(); closeMobileMenu()" id="logoutBtnMobile">Cerrar Sesión</a>
                    </div>
                </li>
            </ul>
        </div>
    </header>

    <!-- Home Page -->
    <div id="home" class="page active">
        <section class="hero">
            <div class="container">
                <div class="hero-content fade-in">
                    <h1>Brew Detective</h1>
                    <p>Conviértete en un detective del café. Resuelve misterios, descifra sabores y compite por el primer lugar en el ranking de catadores más expertos.</p>
                    <a href="/order" class="cta-button">Iniciar Investigación</a>
                </div>
            </div>
            <div class="scroll-indicator">
                <div class="scroll-arrow">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
                <p>Desliza para descubrir más</p>
            </div>
        </section>

        <section class="section section--reduced-top">
            <div class="container">
                <h2 class="section-title">¿Cómo Funciona?</h2>
                <div class="cards-grid symmetric">
                    <div class="card fade-in">
                        <h3>📦 Ordena tu Caja Misteriosa</h3>
                        <p>Solicita tu caja con 4 cafés costarricenses misteriosos de 80g cada uno. <strong>₡18,000</strong></p>
                    </div>
                    <div class="card fade-in">
                        <h3>☕ Recibe y Cata</h3>
                        <p>Sin etiquetas, sin pistas... solo tu paladar y tu intuición para descubrir los secretos.</p>
                    </div>
                    <div class="card fade-in">
                        <h3>🔍 Analiza las Evidencias</h3>
                        <p>Usa tus sentidos para descubrir la región, variedad, proceso y más. Cada detalle es importante.</p>
                    </div>
                    <div class="card fade-in">
                        <h3>💡 Resuelve el Misterio</h3>
                        <p>Responde nuestras preguntas detectivescas y envía tus conclusiones. Cada respuesta correcta suma puntos.</p>
                    </div>
                    <div class="card fade-in">
                        <h3>🏆 Compite en el Ranking</h3>
                        <p>Sube en el ranking de detectives. Gana insignias, desbloquea logros y conviértete en el mejor detective del café.</p>
                    </div>
                    <div class="card fade-in">
                        <h3>🎉 Disfruta el Proceso</h3>
                        <p>Aprende sobre el café costarricense mientras te diviertes y conectas con otros amantes del café.</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="section">
            <div class="container">
                <h2 class="section-title">Tipos de Misterios</h2>
                <div class="cards-grid symmetric">
                    <div class="card fade-in">
                        <h3>🌍 Caso Origen</h3>
                        <p>¿De qué región de Costa Rica viene este café? ¿Qué finca? Descifra las pistas en cada sorbo.</p>
                    </div>
                    <div class="card fade-in">
                        <h3>⚙️ Caso Proceso</h3>
                        <p>¿Lavado, natural, honey? El proceso de beneficiado deja huellas únicas.</p>
                    </div>
                    <div class="card fade-in">
                        <h3>🌱 Caso Variedad</h3>
                        <p>¿Caturra, Bourbon, Geisha? Cada variedad tiene su personalidad única.</p>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Order Page -->
    <div id="order" class="page">
        <section class="section">
            <div class="container">
                <h2 class="section-title">Ordenar Caja Detective</h2>
                <div class="form-container">
                    <h3 class="order-pricing">💰 Precio: ₡18,000</h3>
                    <p class="order-description">
                        Incluye 4 cafés costarricenses misteriosos de 80g cada uno + guía de cata + acceso al juego online
                    </p>
                    
                    <!-- Authenticated User Content -->
                    <div id="orderAuthenticatedContent" class="order-content--authenticated">
                        <button onclick="openWhatsAppOrder()" class="cta-button">
                            📱 Ordenar por WhatsApp
                        </button>
                        <p class="order-note">
                            Te contactaremos para coordinar la entrega y el pago
                        </p>
                    </div>
                    
                    <!-- Unauthenticated User Content -->
                    <div id="orderUnauthenticatedContent" class="order-content--unauthenticated">
                        <div class="login-prompt">
                            <h4 class="login-prompt__title">🔐 Inicia Sesión para Ordenar</h4>
                            <p class="login-prompt__description">
                                Para poder ordenar tu caja detective, necesitas tener una cuenta. Esto nos permite:
                            </p>
                            <div class="login-prompt__benefits">
                                <div class="login-prompt__benefits-item">
                                    ✓ Gestionar tus pedidos y entregas
                                </div>
                                <div class="login-prompt__benefits-item">
                                    ✓ Guardar tu progreso como detective
                                </div>
                                <div class="login-prompt__benefits-item">
                                    ✓ Acceder a tu historial de casos
                                </div>
                                <div class="login-prompt__benefits-item">
                                    ✓ Participar en el ranking de detectives
                                </div>
                            </div>
                            <button onclick="Auth.login()" class="cta-button">
                                🚀 Iniciar Sesión con Google
                            </button>
                            <p class="login-prompt__note">
                                Es rápido, seguro y gratuito
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Submit Page -->
    <div id="submit" class="page">
        <section class="section">
            <div class="container">
                <h2 class="section-title">Enviar Respuestas del Caso</h2>
                
                <!-- Scoring Information Box -->
                <div id="scoringInfoBox" class="scoring-info">
                    <h3 class="scoring-info__title">
                        <span class="scoring-info__title-icon">🎯</span>
                        Sistema de Puntuación
                    </h3>
                    <div class="scoring-info__grid">
                        <div>
                            <h4 class="scoring-info__section-title">📊 Puntos por Café</h4>
                            <div id="coffeeQuestionsList" class="scoring-info__list">
                                <div class="scoring-info__list--loading">Cargando preguntas del caso...</div>
                            </div>
                        </div>
                        <div>
                            <h4 class="scoring-info__section-title">⭐ Puntos Bonus</h4>
                            <div id="bonusQuestionsList" class="scoring-info__list">
                                <div class="scoring-info__list--loading">Cargando preguntas bonus...</div>
                            </div>
                            <div id="maxScoreDisplay" class="scoring-info__max-score">
                                <strong>🏆 Máximo: -- puntos</strong>
                            </div>
                        </div>
                    </div>
                    <div class="scoring-info__tip">
                        <p>
                            <strong>💡 Consejo:</strong> El puntaje se adapta automáticamente según las preguntas habilitadas para este caso. 
                            ¡Cada respuesta correcta contribuye a tu precisión total!
                        </p>
                    </div>
                </div>
                
                <div class="form-container">
                    <div class="success-message" id="submitSuccess">
                        ¡Caso resuelto exitosamente! Tus respuestas han sido enviadas.
                    </div>
                    <div class="error-message" id="submitError">
                        Error al enviar respuestas. Por favor intenta nuevamente.
                    </div>
                    <div class="form-group">
                        <label>Caso Activo:</label>
                        <div id="activeCaseDisplay" class="active-case-display">
                            <div class="active-case-display__header">
                                <span class="active-case-display__header-icon">📦</span>
                                <span id="activeCaseName" class="active-case-display__header-name">Cargando caso activo...</span>
                            </div>
                            <div id="activeCaseDescription" class="active-case-display__description"></div>
                        </div>
                    </div>
                    
                    <form id="submitForm">
                        <div class="form-group">
                            <label for="orderId">ID de Orden (6 caracteres):</label>
                            <input type="text" id="orderId" placeholder="Ej: ABC123" maxlength="6" required class="text-uppercase-input">
                            <small class="form-helper">
                                Este código fue enviado con tu orden de café. Es necesario para validar tu compra.
                            </small>
                        </div>
                        
                        <h3 class="coffee-heading">☕ Café #1</h3>
                        <div class="form-group">
                            <label for="coffee1_region">Región de Costa Rica:</label>
                            <select id="coffee1_region" required>
                                <option value="">Selecciona una región</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="coffee1_variety">Variedad:</label>
                            <select id="coffee1_variety" required>
                                <option value="">Selecciona una variedad</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="coffee1_process">Proceso de Beneficiado:</label>
                            <select id="coffee1_process" required>
                                <option value="">Selecciona un proceso</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="coffee1_note1">Primera Nota de Sabor:</label>
                            <input type="text" id="coffee1_note1" placeholder="Ej: Chocolate, Frutal, Floral, Nuez..." maxlength="50">
                        </div>
                        <div class="form-group">
                            <label for="coffee1_note2">Segunda Nota de Sabor:</label>
                            <input type="text" id="coffee1_note2" placeholder="Ej: Cítrico, Caramelo, Especias, Miel..." maxlength="50">
                        </div>

                        <h3 class="coffee-heading">☕ Café #2</h3>
                        <div class="form-group">
                            <label for="coffee2_region">Región de Costa Rica:</label>
                            <select id="coffee2_region" required>
                                <option value="">Selecciona una región</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="coffee2_variety">Variedad:</label>
                            <select id="coffee2_variety" required>
                                <option value="">Selecciona una variedad</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="coffee2_process">Proceso de Beneficiado:</label>
                            <select id="coffee2_process" required>
                                <option value="">Selecciona un proceso</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="coffee2_note1">Primera Nota de Sabor:</label>
                            <input type="text" id="coffee2_note1" placeholder="Ej: Chocolate, Frutal, Floral, Nuez..." maxlength="50">
                        </div>
                        <div class="form-group">
                            <label for="coffee2_note2">Segunda Nota de Sabor:</label>
                            <input type="text" id="coffee2_note2" placeholder="Ej: Cítrico, Caramelo, Especias, Miel..." maxlength="50">
                        </div>

                        <h3 class="coffee-heading">☕ Café #3</h3>
                        <div class="form-group">
                            <label for="coffee3_region">Región de Costa Rica:</label>
                            <select id="coffee3_region" required>
                                <option value="">Selecciona una región</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="coffee3_variety">Variedad:</label>
                            <select id="coffee3_variety" required>
                                <option value="">Selecciona una variedad</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="coffee3_process">Proceso de Beneficiado:</label>
                            <select id="coffee3_process" required>
                                <option value="">Selecciona un proceso</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="coffee3_note1">Primera Nota de Sabor:</label>
                            <input type="text" id="coffee3_note1" placeholder="Ej: Chocolate, Frutal, Floral, Nuez..." maxlength="50">
                        </div>
                        <div class="form-group">
                            <label for="coffee3_note2">Segunda Nota de Sabor:</label>
                            <input type="text" id="coffee3_note2" placeholder="Ej: Cítrico, Caramelo, Especias, Miel..." maxlength="50">
                        </div>

                        <h3 class="coffee-heading">☕ Café #4</h3>
                        <div class="form-group">
                            <label for="coffee4_region">Región de Costa Rica:</label>
                            <select id="coffee4_region" required>
                                <option value="">Selecciona una región</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="coffee4_variety">Variedad:</label>
                            <select id="coffee4_variety" required>
                                <option value="">Selecciona una variedad</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="coffee4_process">Proceso de Beneficiado:</label>
                            <select id="coffee4_process" required>
                                <option value="">Selecciona un proceso</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="coffee4_note1">Primera Nota de Sabor:</label>
                            <input type="text" id="coffee4_note1" placeholder="Ej: Chocolate, Frutal, Floral, Nuez..." maxlength="50">
                        </div>
                        <div class="form-group">
                            <label for="coffee4_note2">Segunda Nota de Sabor:</label>
                            <input type="text" id="coffee4_note2" placeholder="Ej: Cítrico, Caramelo, Especias, Miel..." maxlength="50">
                        </div>

                        <h3 class="coffee-heading">🔍 Preguntas Bonus</h3>
                        <div class="form-group">
                            <label for="favorite_coffee">¿Cuál fue tu café favorito y por qué?</label>
                            <textarea id="favorite_coffee" rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="brewing_method">¿En qué método de preparación lo disfrutaste más?</label>
                            <select id="brewing_method">
                                <option value="">Selecciona un método</option>
                            </select>
                        </div>

                        <button type="submit" class="cta-button">Enviar Solución del Caso</button>
                    </form>
                </div>
            </div>
        </section>
    </div>

    <!-- Leaderboard Page -->
    <div id="leaderboard" class="page">
        <section class="section">
            <div class="container">
                <h2 class="section-title">Ranking de Detectives</h2>
                
                <!-- Current Case Leaderboard -->
                <div class="card leaderboard-section">
                    <h3 class="leaderboard-section__title">🏆 Caso Actual</h3>
                    <div id="currentCaseInfo" class="leaderboard-section__info">
                        <p>Cargando información del caso...</p>
                    </div>
                    <div id="currentCaseLeaderboard" class="leaderboard">
                        <!-- Current case leaderboard entries will be loaded dynamically -->
                    </div>
                </div>
                
                <!-- Global/Historical Leaderboard -->
                <div class="card">
                    <h3 class="leaderboard-section__title">🌟 Ranking Global</h3>
                    <p class="leaderboard-section__description">Puntuación acumulada de todos los casos resueltos</p>
                    <div id="globalLeaderboard" class="leaderboard">
                        <!-- Global leaderboard entries will be loaded dynamically -->
                    </div>
                </div>
                
                <div class="leaderboard-footer">
                    <p class="leaderboard-footer__title">🏆 Rankings actualizados en tiempo real</p>
                    <p class="leaderboard-footer__description">¡Completa más casos para subir en el ranking!</p>
                </div>
            </div>
        </section>
    </div>

    <!-- Profile Page -->
    <div id="profile" class="page">
        <section class="section">
            <div class="container">
                <h2 class="section-title">Mi Perfil de Detective</h2>
                <div class="cards-grid">
                    <div class="card">
                        <h3>👤 Información Personal</h3>
                        <div class="form-container profile-form-transparent">
                            <div class="form-group">
                                <label for="profileName">Nombre del Detective:</label>
                                <input type="text" id="profileName" placeholder="Ingresa tu nombre">
                            </div>
                            <div class="form-group">
                                <label for="profileEmail">Email:</label>
                                <input type="email" id="profileEmail" placeholder="tu@email.com">
                            </div>
                            <button type="button" class="cta-button" onclick="saveProfile()">Actualizar Perfil</button>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h3>📊 Mis Estadísticas</h3>
                        
                        <!-- Global Stats -->
                        <div class="stats-section">
                            <h4 class="stats-section__title">🌟 Estadísticas Globales</h4>
                            <div class="stats-section__container">
                                <div class="stats-section__item">
                                    <div class="stats-section__value stats-section__value--large" data-stat="points">0</div>
                                    <div>Puntos Totales</div>
                                </div>
                                <div class="stats-section__item">
                                    <div class="stats-section__value" data-stat="global-rank"># --</div>
                                    <div>Ranking Global</div>
                                </div>
                                <div class="stats-section__item">
                                    <div class="stats-section__value" data-stat="cases">0</div>
                                    <div>Casos Completados</div>
                                </div>
                                <div class="stats-section__item">
                                    <div class="stats-section__value" data-stat="accuracy">0%</div>
                                    <div>Precisión Promedio</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Current Case Stats -->
                        <div>
                            <h4 class="stats-section__title">🏆 Caso Actual</h4>
                            <div class="stats-section__container">
                                <div class="stats-section__item">
                                    <div class="stats-section__value" data-stat="current-rank"># --</div>
                                    <div>Posición en Caso Actual</div>
                                </div>
                                <div class="stats-section__item">
                                    <div class="stats-section__value" data-stat="current-score">--</div>
                                    <div>Mejor Puntuación</div>
                                </div>
                                <div class="stats-section__item">
                                    <div class="stats-section__value" data-stat="current-accuracy">--%</div>
                                    <div>Precisión en Caso Actual</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card margin-top-2">
                    <h3>🏅 Mis Insignias</h3>
                    <div id="userBadgesContainer" class="profile-badges__container">
                        <span class="badge">🔍 Primer Caso</span>
                        <span class="badge">🌍 Experto en Orígenes</span>
                        <span class="badge">☕ Catador Nivel 1</span>
                        <span class="badge">🎯 Precisión 70%</span>
                    </div>
                    <div class="profile-badges__upcoming">
                        <p>Próximas insignias por desbloquear:</p>
                        <div class="profile-badges__upcoming-title">
                            <span class="profile-badges__upcoming-item">🏆 Detective Maestro (necesitas 2,000 pts)</span><br>
                            <span class="profile-badges__upcoming-item">🔥 Experto en Tuestes (necesitas 5 casos)</span><br>
                            <span class="profile-badges__upcoming-item">💎 Catador Nivel 2 (necesitas 80% precisión)</span>
                        </div>
                    </div>
                </div>

                <div class="card margin-top-2">
                    <h3>📋 Historial de Casos</h3>
                    <div id="caseHistoryContainer" class="profile-history__container">
                        <div class="profile-history__loading">
                            <p>Cargando historial de casos...</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Admin Page -->
    <div id="admin" class="page">
        <section class="section">
            <div class="container">
                <h2 class="section-title">Panel de Administración</h2>
                
                <!-- Case Management -->
                <div class="card">
                    <h3>📦 Gestión de Casos</h3>
                    
                    <!-- Case Creation Form -->
                    <div id="caseManagementSection">
                        <div class="form-group admin-section__buttons">
                            <button type="button" onclick="showCreateCaseForm()" class="cta-button admin-section__button">Crear Nuevo Caso</button>
                            <button type="button" onclick="loadAllCases()" class="cta-button cta-button--secondary admin-section__button">Ver Todos los Casos</button>
                        </div>

                        <!-- Create Case Form -->
                        <div id="createCaseForm" class="admin-section__form">
                            <h4>Crear Nuevo Caso</h4>
                            <div class="form-group">
                                <label for="caseName">Nombre del Caso:</label>
                                <input type="text" id="caseName" placeholder="ej: Misterio del Valle Central" class="admin-section__input">
                            </div>
                            <div class="form-group">
                                <label for="caseDescription">Descripción:</label>
                                <textarea id="caseDescription" rows="3" placeholder="Descripción del caso de café..." class="admin-section__input"></textarea>
                            </div>

                            <!-- Coffee 1 -->
                            <h5 class="admin-section__coffee-heading">☕ Café #1</h5>
                            <div class="form-group">
                                <label for="coffee1Name">Nombre del Café:</label>
                                <input type="text" id="coffee1Name" placeholder="ej: Finca La Esperanza" class="admin-section__input">
                            </div>
                            <div class="form-group">
                                <label for="coffee1Region">Región:</label>
                                <select id="coffee1Region" class="admin-section__input">
                                    <option value="">Selecciona una región</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="coffee1Variety">Variedad:</label>
                                <select id="coffee1Variety" class="admin-section__input">
                                    <option value="">Selecciona una variedad</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="coffee1Process">Proceso:</label>
                                <select id="coffee1Process" class="admin-section__input">
                                    <option value="">Selecciona un proceso</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="coffee1Notes">Notas de Cata:</label>
                                <input type="text" id="coffee1Notes" placeholder="ej: Chocolate, Cítrico, Caramelo (separar con comas)" class="admin-section__input">
                                <small class="form-helper form-helper--small">
                                    Las notas reales del café, separadas por comas
                                </small>
                            </div>

                            <!-- Coffee 2 -->
                            <h5 class="admin-section__coffee-heading">☕ Café #2</h5>
                            <div class="form-group">
                                <label for="coffee2Name">Nombre del Café:</label>
                                <input type="text" id="coffee2Name" placeholder="ej: Finca El Mirador" class="admin-section__input">
                            </div>
                            <div class="form-group">
                                <label for="coffee2Region">Región:</label>
                                <select id="coffee2Region" class="admin-section__input">
                                    <option value="">Selecciona una región</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="coffee2Variety">Variedad:</label>
                                <select id="coffee2Variety" class="admin-section__input">
                                    <option value="">Selecciona una variedad</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="coffee2Process">Proceso:</label>
                                <select id="coffee2Process" class="admin-section__input">
                                    <option value="">Selecciona un proceso</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="coffee2Notes">Notas de Cata:</label>
                                <input type="text" id="coffee2Notes" placeholder="ej: Chocolate, Cítrico, Caramelo (separar con comas)" class="admin-section__input">
                                <small class="form-helper form-helper--small">
                                    Las notas reales del café, separadas por comas
                                </small>
                            </div>

                            <!-- Coffee 3 -->
                            <h5 class="admin-section__coffee-heading">☕ Café #3</h5>
                            <div class="form-group">
                                <label for="coffee3Name">Nombre del Café:</label>
                                <input type="text" id="coffee3Name" placeholder="ej: Finca Las Nubes" class="admin-section__input">
                            </div>
                            <div class="form-group">
                                <label for="coffee3Region">Región:</label>
                                <select id="coffee3Region" class="admin-section__input">
                                    <option value="">Selecciona una región</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="coffee3Variety">Variedad:</label>
                                <select id="coffee3Variety" class="admin-section__input">
                                    <option value="">Selecciona una variedad</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="coffee3Process">Proceso:</label>
                                <select id="coffee3Process" class="admin-section__input">
                                    <option value="">Selecciona un proceso</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="coffee3Notes">Notas de Cata:</label>
                                <input type="text" id="coffee3Notes" placeholder="ej: Chocolate, Cítrico, Caramelo (separar con comas)" class="admin-section__input">
                                <small class="form-helper form-helper--small">
                                    Las notas reales del café, separadas por comas
                                </small>
                            </div>

                            <!-- Coffee 4 -->
                            <h5 class="admin-section__coffee-heading">☕ Café #4</h5>
                            <div class="form-group">
                                <label for="coffee4Name">Nombre del Café:</label>
                                <input type="text" id="coffee4Name" placeholder="ej: Finca El Volcán" class="admin-section__input">
                            </div>
                            <div class="form-group">
                                <label for="coffee4Region">Región:</label>
                                <select id="coffee4Region" class="admin-section__input">
                                    <option value="">Selecciona una región</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="coffee4Variety">Variedad:</label>
                                <select id="coffee4Variety" class="admin-section__input">
                                    <option value="">Selecciona una variedad</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="coffee4Process">Proceso:</label>
                                <select id="coffee4Process" class="admin-section__input">
                                    <option value="">Selecciona un proceso</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="coffee4Notes">Notas de Cata:</label>
                                <input type="text" id="coffee4Notes" placeholder="ej: Chocolate, Cítrico, Caramelo (separar con comas)" class="admin-section__input">
                                <small class="form-helper form-helper--small">
                                    Las notas reales del café, separadas por comas
                                </small>
                            </div>

                            <!-- Question Configuration -->
                            <h5 class="admin-section__coffee-heading">❓ Configuración de Preguntas</h5>
                            <p class="admin-section__description">Selecciona qué preguntas hacer a los usuarios durante la evaluación:</p>
                            
                            <div class="admin-section__grid">
                                <label class="admin-section__checkbox-label">
                                    <input type="checkbox" id="questionRegion" checked class="admin-section__input">
                                    <span>Región</span>
                                </label>
                                <label class="admin-section__checkbox-label">
                                    <input type="checkbox" id="questionVariety" checked class="admin-section__input">
                                    <span>Variedad</span>
                                </label>
                                <label class="admin-section__checkbox-label">
                                    <input type="checkbox" id="questionProcess" checked class="admin-section__input">
                                    <span>Proceso</span>
                                </label>
                                <label class="admin-section__checkbox-label">
                                    <input type="checkbox" id="questionTasteNote1" checked class="admin-section__input">
                                    <span>Primera Nota de Sabor</span>
                                </label>
                                <label class="admin-section__checkbox-label">
                                    <input type="checkbox" id="questionTasteNote2" checked class="admin-section__input">
                                    <span>Segunda Nota de Sabor</span>
                                </label>
                                <label class="admin-section__checkbox-label">
                                    <input type="checkbox" id="questionFavoriteCoffee" checked class="admin-section__input">
                                    <span>Café Favorito</span>
                                </label>
                                <label class="admin-section__checkbox-label">
                                    <input type="checkbox" id="questionBrewingMethod" checked class="admin-section__input">
                                    <span>Método de Preparación</span>
                                </label>
                            </div>

                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="caseIsActive" class="admin-section__input"> Activar caso inmediatamente
                                </label>
                            </div>

                            <button type="button" onclick="createCase()" class="cta-button admin-section__button">Crear Caso</button>
                            <button type="button" onclick="cancelCreateCase()" class="cta-button admin-section__button--cancel">Cancelar</button>
                        </div>

                        <!-- Edit Case Form -->
                        <div id="editCaseForm" class="admin-section__form">
                            <h4>Editar Caso</h4>
                            <input type="hidden" id="editCaseId">
                            <div class="form-group">
                                <label for="editCaseName">Nombre del Caso:</label>
                                <input type="text" id="editCaseName" placeholder="ej: Misterio del Valle Central" class="admin-section__input">
                            </div>
                            <div class="form-group">
                                <label for="editCaseDescription">Descripción:</label>
                                <textarea id="editCaseDescription" rows="3" placeholder="Descripción del caso de café..." class="admin-section__input"></textarea>
                            </div>

                            <!-- Coffee 1 -->
                            <h5 class="admin-section__coffee-heading">☕ Café #1</h5>
                            <div class="form-group">
                                <label for="editCoffee1Name">Nombre del Café:</label>
                                <input type="text" id="editCoffee1Name" placeholder="ej: Finca La Esperanza" class="admin-section__input">
                            </div>
                            <div class="form-group">
                                <label for="editCoffee1Region">Región:</label>
                                <select id="editCoffee1Region" class="admin-section__input">
                                    <option value="">Selecciona una región</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="editCoffee1Variety">Variedad:</label>
                                <select id="editCoffee1Variety" class="admin-section__input">
                                    <option value="">Selecciona una variedad</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="editCoffee1Process">Proceso:</label>
                                <select id="editCoffee1Process" class="admin-section__input">
                                    <option value="">Selecciona un proceso</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="editCoffee1Notes">Notas de Cata:</label>
                                <input type="text" id="editCoffee1Notes" placeholder="ej: Chocolate, Cítrico, Caramelo (separar con comas)" class="admin-section__input">
                                <small class="form-helper form-helper--small">
                                    Las notas reales del café, separadas por comas
                                </small>
                            </div>

                            <!-- Coffee 2 -->
                            <h5 class="admin-section__coffee-heading">☕ Café #2</h5>
                            <div class="form-group">
                                <label for="editCoffee2Name">Nombre del Café:</label>
                                <input type="text" id="editCoffee2Name" placeholder="ej: Finca El Mirador" class="admin-section__input">
                            </div>
                            <div class="form-group">
                                <label for="editCoffee2Region">Región:</label>
                                <select id="editCoffee2Region" class="admin-section__input">
                                    <option value="">Selecciona una región</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="editCoffee2Variety">Variedad:</label>
                                <select id="editCoffee2Variety" class="admin-section__input">
                                    <option value="">Selecciona una variedad</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="editCoffee2Process">Proceso:</label>
                                <select id="editCoffee2Process" class="admin-section__input">
                                    <option value="">Selecciona un proceso</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="editCoffee2Notes">Notas de Cata:</label>
                                <input type="text" id="editCoffee2Notes" placeholder="ej: Chocolate, Cítrico, Caramelo (separar con comas)" class="admin-section__input">
                                <small class="form-helper form-helper--small">
                                    Las notas reales del café, separadas por comas
                                </small>
                            </div>

                            <!-- Coffee 3 -->
                            <h5 class="admin-section__coffee-heading">☕ Café #3</h5>
                            <div class="form-group">
                                <label for="editCoffee3Name">Nombre del Café:</label>
                                <input type="text" id="editCoffee3Name" placeholder="ej: Finca Las Nubes" class="admin-section__input">
                            </div>
                            <div class="form-group">
                                <label for="editCoffee3Region">Región:</label>
                                <select id="editCoffee3Region" class="admin-section__input">
                                    <option value="">Selecciona una región</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="editCoffee3Variety">Variedad:</label>
                                <select id="editCoffee3Variety" class="admin-section__input">
                                    <option value="">Selecciona una variedad</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="editCoffee3Process">Proceso:</label>
                                <select id="editCoffee3Process" class="admin-section__input">
                                    <option value="">Selecciona un proceso</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="editCoffee3Notes">Notas de Cata:</label>
                                <input type="text" id="editCoffee3Notes" placeholder="ej: Chocolate, Cítrico, Caramelo (separar con comas)" class="admin-section__input">
                                <small class="form-helper form-helper--small">
                                    Las notas reales del café, separadas por comas
                                </small>
                            </div>

                            <!-- Coffee 4 -->
                            <h5 class="admin-section__coffee-heading">☕ Café #4</h5>
                            <div class="form-group">
                                <label for="editCoffee4Name">Nombre del Café:</label>
                                <input type="text" id="editCoffee4Name" placeholder="ej: Finca El Volcán" class="admin-section__input">
                            </div>
                            <div class="form-group">
                                <label for="editCoffee4Region">Región:</label>
                                <select id="editCoffee4Region" class="admin-section__input">
                                    <option value="">Selecciona una región</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="editCoffee4Variety">Variedad:</label>
                                <select id="editCoffee4Variety" class="admin-section__input">
                                    <option value="">Selecciona una variedad</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="editCoffee4Process">Proceso:</label>
                                <select id="editCoffee4Process" class="admin-section__input">
                                    <option value="">Selecciona un proceso</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="editCoffee4Notes">Notas de Cata:</label>
                                <input type="text" id="editCoffee4Notes" placeholder="ej: Chocolate, Cítrico, Caramelo (separar con comas)" class="admin-section__input">
                                <small class="form-helper form-helper--small">
                                    Las notas reales del café, separadas por comas
                                </small>
                            </div>

                            <!-- Question Configuration -->
                            <h5 class="admin-section__coffee-heading">❓ Configuración de Preguntas</h5>
                            <p class="admin-section__description">Selecciona qué preguntas hacer a los usuarios durante la evaluación:</p>
                            
                            <div class="admin-section__grid">
                                <label class="admin-section__checkbox-label">
                                    <input type="checkbox" id="editQuestionRegion" class="admin-section__input">
                                    <span>Región</span>
                                </label>
                                <label class="admin-section__checkbox-label">
                                    <input type="checkbox" id="editQuestionVariety" class="admin-section__input">
                                    <span>Variedad</span>
                                </label>
                                <label class="admin-section__checkbox-label">
                                    <input type="checkbox" id="editQuestionProcess" class="admin-section__input">
                                    <span>Proceso</span>
                                </label>
                                <label class="admin-section__checkbox-label">
                                    <input type="checkbox" id="editQuestionTasteNote1" class="admin-section__input">
                                    <span>Primera Nota de Sabor</span>
                                </label>
                                <label class="admin-section__checkbox-label">
                                    <input type="checkbox" id="editQuestionTasteNote2" class="admin-section__input">
                                    <span>Segunda Nota de Sabor</span>
                                </label>
                                <label class="admin-section__checkbox-label">
                                    <input type="checkbox" id="editQuestionFavoriteCoffee" class="admin-section__input">
                                    <span>Café Favorito</span>
                                </label>
                                <label class="admin-section__checkbox-label">
                                    <input type="checkbox" id="editQuestionBrewingMethod" class="admin-section__input">
                                    <span>Método de Preparación</span>
                                </label>
                            </div>

                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="editCaseIsActive" class="admin-section__input"> Caso activo
                                </label>
                            </div>

                            <button type="button" onclick="updateCase()" class="cta-button admin-section__button">Actualizar Caso</button>
                            <button type="button" onclick="cancelEditCase()" class="cta-button admin-section__button--cancel">Cancelar</button>
                        </div>

                        <!-- Cases List -->
                        <div id="casesList" class="admin-section__list">
                            <!-- Cases will be loaded here -->
                        </div>
                    </div>
                </div>

                <!-- Order Management -->
                <div class="card">
                    <h3>📋 Gestión de Órdenes</h3>
                    
                    <!-- Order Creation Form -->
                    <div id="orderManagementSection">
                        <div class="form-group">
                            <button type="button" onclick="showCreateOrderForm()" class="cta-button admin-section__button">Crear Nueva Orden</button>
                            <button type="button" onclick="loadAllOrders()" class="cta-button cta-button--secondary admin-section__button">Ver Todas las Órdenes</button>
                        </div>

                        <!-- Create Order Form -->
                        <div id="createOrderForm" class="admin-section__form">
                            <h4>Crear Nueva Orden</h4>
                            <div class="form-group">
                                <label for="orderUserSelect">Usuario:</label>
                                <select id="orderUserSelect" required class="admin-section__input">
                                    <option value="">Selecciona un usuario</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="orderCaseSelect">Caso:</label>
                                <select id="orderCaseSelect" required class="admin-section__input">
                                    <option value="">Selecciona un caso</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="orderContactInfo">Información de Contacto:</label>
                                <textarea id="orderContactInfo" rows="3" placeholder="Teléfono, WhatsApp, dirección, etc." class="admin-section__input"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="orderAmount">Monto Total (₡):</label>
                                <input type="number" id="orderAmount" placeholder="18000" min="0" class="admin-section__input">
                            </div>
                            <div class="form-group">
                                <label for="orderStatus">Estado:</label>
                                <select id="orderStatus" class="admin-section__input">
                                    <option value="pending">Pendiente</option>
                                    <option value="confirmed">Confirmada</option>
                                    <option value="shipped">Enviada</option>
                                    <option value="delivered">Entregada</option>
                                </select>
                            </div>

                            <button type="button" onclick="createOrder()" class="cta-button admin-section__button">Crear Orden</button>
                            <button type="button" onclick="cancelCreateOrder()" class="cta-button admin-section__button--cancel">Cancelar</button>
                        </div>

                        <!-- Orders List -->
                        <div id="ordersList" class="admin-section__list">
                            <!-- Orders will be loaded here -->
                        </div>
                    </div>
                </div>

                <!-- Catalog Management -->
                <div class="card">
                    <h3>🗂️ Gestión de Catálogos</h3>
                    
                    <!-- Category Selector -->
                    <div class="form-group">
                        <label for="adminCategorySelect">Categoría:</label>
                        <select id="adminCategorySelect" onchange="loadCatalogItems()" class="admin-section__select">
                            <option value="">Selecciona una categoría</option>
                            <option value="region">Regiones</option>
                            <option value="variety">Variedades</option>
                            <option value="process">Procesos de Beneficiado</option>
                            <option value="brewing_method">Métodos de Preparación</option>
                        </select>
                    </div>

                    <!-- Add New Item Form -->
                    <div id="addItemForm" class="admin-section__form">
                        <h4>Agregar Nuevo Item</h4>
                        <div class="form-group">
                            <label for="newItemValue">Valor (ID interno):</label>
                            <input type="text" id="newItemValue" placeholder="ej: central_valley" class="admin-section__input">
                        </div>
                        <div class="form-group">
                            <label for="newItemLabel">Etiqueta (Nombre mostrado):</label>
                            <input type="text" id="newItemLabel" placeholder="ej: Valle Central" class="admin-section__input">
                        </div>
                        <div class="form-group">
                            <label for="newItemOrder">Orden de Visualización:</label>
                            <input type="number" id="newItemOrder" value="0" min="0" class="admin-section__input">
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="newItemActive" checked class="admin-section__input"> Activo
                            </label>
                        </div>
                        <button type="button" onclick="createCatalogItem()" class="cta-button admin-section__button">Crear Item</button>
                        <button type="button" onclick="cancelAddItem()" class="cta-button admin-section__button--cancel">Cancelar</button>
                    </div>

                    <!-- Actions -->
                    <div class="margin-vertical-1 z-10">
                        <button type="button" onclick="showAddItemForm()" class="cta-button hidden" id="addItemBtn">Agregar Nuevo Item</button>
                        <button type="button" onclick="loadCatalogItems()" class="cta-button cta-button--secondary hidden" id="refreshBtn">Actualizar Lista</button>
                    </div>

                    <!-- Catalog Items List -->
                    <div id="catalogItemsList" class="admin-section__list">
                        <!-- Items will be loaded here -->
                    </div>
                </div>

                <!-- Success/Error Messages -->
                <div id="adminSuccess" class="success-message margin-top-1">
                    Operación completada exitosamente
                </div>
                <div id="adminError" class="error-message margin-top-1">
                    Error en la operación
                </div>
            </div>
        </section>
    </div>

    <!-- Thank You Page -->
    <div id="thankyou" class="page">
        <section class="section">
            <div class="container">
                <div class="card thank-you-page__card">
                    <div class="thank-you-page__content">
                        <div class="thank-you-page__icon">🎉</div>
                        <h2 class="thank-you-page__title">¡Respuestas Enviadas Exitosamente!</h2>
                        <p class="thank-you-page__description">
                            Gracias por participar en este caso detective. Tu análisis ha sido registrado.
                        </p>
                    </div>

                    <div id="scoreDisplay" style="background: linear-gradient(135deg, rgba(212, 175, 55, 0.2), rgba(212, 175, 55, 0.1)); border: 2px solid rgba(212, 175, 55, 0.3); border-radius: 12px; padding: 1.5rem; margin: 2rem 0;">
                        <h3 style="color: #d4af37; margin-bottom: 1rem;">Tu Puntuación</h3>
                        <div style="display: flex; justify-content: space-around; align-items: center; flex-wrap: wrap; gap: 1rem;">
                            <div>
                                <div style="font-size: 2.5rem; font-weight: bold; color: #d4af37;" id="finalScore">--</div>
                                <div style="color: rgba(244, 241, 232, 0.8); font-size: 0.9rem;">Puntos Totales</div>
                            </div>
                            <div>
                                <div style="font-size: 2.5rem; font-weight: bold; color: #d4af37;" id="finalAccuracy">--%</div>
                                <div style="color: rgba(244, 241, 232, 0.8); font-size: 0.9rem;">Precisión</div>
                            </div>
                        </div>
                    </div>

                    <div style="margin: 2rem 0;">
                        <h4 style="color: #d4af37; margin-bottom: 1rem;">🚀 ¿Qué sigue?</h4>
                        <div style="text-align: left; margin-bottom: 2rem;">
                            <div style="margin-bottom: 0.8rem; color: rgba(244, 241, 232, 0.9);">
                                ✓ Ve tu posición en el ranking de detectives
                            </div>
                            <div style="margin-bottom: 0.8rem; color: rgba(244, 241, 232, 0.9);">
                                ✓ Actualiza tu perfil con tu experiencia
                            </div>
                        </div>
                    </div>

                    <div style="display: flex; flex-direction: column; gap: 1rem; max-width: 300px; margin: 0 auto;">
                        <a href="/leaderboard" class="cta-button">
                            🏆 Ver Ranking
                        </a>
                        <a href="/profile" class="cta-button">
                            👤 Mi Perfil
                        </a>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">🔍 Brew Detective</div>
                <div class="footer-divider"></div>
                <div style="display: flex; align-items: center; gap: 0.5rem;">
                    <span>Una experiencia creada por</span>
                    <a href="https://instagram.com/sinfonia_cafe_cr" class="footer-brand" target="_blank" rel="noopener noreferrer">
                        <img src="images/sinfonia-logo.png" alt="Sinfonía Café" class="footer-profile-pic">
                        <strong>Sinfonía Café</strong>
                    </a>
                </div>
            </div>
            <div class="footer-text">
                <p>© 2025 Brew Detective. Todos los derechos reservados.</p>
                <p>Síguenos en <a href="https://instagram.com/sinfonia_cafe_cr" style="color: #d4af37; text-decoration: none;" target="_blank" rel="noopener noreferrer">@sinfonia_cafe_cr</a></p>
            </div>
        </div>
    </footer>

    <script src="js/config.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/main.js"></script>
</body>
</html>