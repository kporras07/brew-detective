<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brew Detective - Resuelve el Misterio del Café</title>
    <link rel="stylesheet" href="css/main.css">
</head>
<body>
    <!-- Header -->
    <header>
        <nav class="container">
            <div class="logo">🔍 Brew Detective</div>
            <ul class="nav-links">
                <li><a href="#" onclick="showPage('home')">Inicio</a></li>
                <li><a href="#" onclick="showPage('order')">Ordenar Caja</a></li>
                <li id="submitMenuItem" style="display: none;"><a href="#" onclick="showPage('submit')">Enviar Respuestas</a></li>
                <li><a href="#" onclick="showPage('leaderboard')">Ranking</a></li>
                <li class="auth-nav" id="authNav">
                    <a href="#" onclick="Auth.login()" id="loginBtn">Iniciar Sesión</a>
                    <div class="user-dropdown" id="userDropdown" style="display: none;">
                        <a href="#" class="user-menu-toggle" id="userMenuToggle" onclick="toggleUserMenu()">
                            <img id="userAvatar" src="" alt="User Avatar" class="user-avatar" style="width: 28px; height: 28px; border-radius: 50%; margin-right: 0.5rem; object-fit: cover; border: 2px solid rgba(212, 175, 55, 0.5);">
                            <span id="userName">Usuario</span>
                            <span class="dropdown-arrow">▼</span>
                        </a>
                        <div class="user-menu" id="userMenu">
                            <a href="#" onclick="showPage('profile'); closeUserMenu()">Mi Perfil</a>
                            <a href="#" onclick="showPage('admin'); closeUserMenu()" id="adminMenuItem" style="display: none;">Administración</a>
                            <a href="#" onclick="Auth.logout()">Cerrar Sesión</a>
                        </div>
                    </div>
                </li>
            </ul>
            <div class="mobile-menu-toggle" onclick="toggleMobileMenu()">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </nav>
        <div class="mobile-nav" id="mobileNav">
            <button class="mobile-close" onclick="closeMobileMenu()">&times;</button>
            <ul>
                <li><a href="#" onclick="showPage('home'); closeMobileMenu()">Inicio</a></li>
                <li><a href="#" onclick="showPage('order'); closeMobileMenu()">Ordenar Caja</a></li>
                <li id="submitMenuItemMobile" style="display: none;"><a href="#" onclick="showPage('submit'); closeMobileMenu()">Enviar Respuestas</a></li>
                <li><a href="#" onclick="showPage('leaderboard'); closeMobileMenu()">Ranking</a></li>
                <li class="auth-nav-mobile" id="authNavMobile">
                    <a href="#" onclick="Auth.login(); closeMobileMenu()" id="loginBtnMobile">Iniciar Sesión</a>
                    <div class="user-dropdown-mobile" id="userDropdownMobile" style="display: none;">
                        <a href="#" onclick="showPage('profile'); closeMobileMenu()" id="profileBtnMobile">Mi Perfil</a>
                        <a href="#" onclick="Auth.logout(); closeMobileMenu()" id="logoutBtnMobile">Cerrar Sesión</a>
                    </div>
                </li>
            </ul>
        </div>
    </header>

    <!-- Home Page -->
    <div id="home" class="page active">
        <section class="hero">
            <div class="container">
                <div class="hero-content fade-in">
                    <h1>Brew Detective</h1>
                    <p>Conviértete en un detective del café. Resuelve misterios, descifra sabores y compite por el primer lugar en el ranking de catadores más expertos.</p>
                    <a href="#" class="cta-button" onclick="showPage('order')">Iniciar Investigación</a>
                </div>
            </div>
            <div class="scroll-indicator">
                <div class="scroll-arrow">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
                <p>Desliza para descubrir más</p>
            </div>
        </section>

        <section class="section section--reduced-top">
            <div class="container">
                <h2 class="section-title">¿Cómo Funciona?</h2>
                <div class="cards-grid symmetric">
                    <div class="card fade-in">
                        <h3>📦 Ordena tu Caja Misteriosa</h3>
                        <p>Solicita tu caja con 4 cafés costarricenses misteriosos de 80g cada uno. <strong>₡18,000</strong></p>
                    </div>
                    <div class="card fade-in">
                        <h3>☕ Recibe y Cata</h3>
                        <p>Sin etiquetas, sin pistas... solo tu paladar y tu intuición para descubrir los secretos.</p>
                    </div>
                    <div class="card fade-in">
                        <h3>🔍 Analiza las Evidencias</h3>
                        <p>Usa tus sentidos para descubrir la región, variedad, proceso y más. Cada detalle es importante.</p>
                    </div>
                    <div class="card fade-in">
                        <h3>💡 Resuelve el Misterio</h3>
                        <p>Responde nuestras preguntas detectivescas y envía tus conclusiones. Cada respuesta correcta suma puntos.</p>
                    </div>
                    <div class="card fade-in">
                        <h3>🏆 Compite en el Ranking</h3>
                        <p>Sube en el ranking de detectives. Gana insignias, desbloquea logros y conviértete en el mejor detective del café.</p>
                    </div>
                    <div class="card fade-in">
                        <h3>🎉 Disfruta el Proceso</h3>
                        <p>Aprende sobre el café costarricense mientras te diviertes y conectas con otros amantes del café.</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="section">
            <div class="container">
                <h2 class="section-title">Tipos de Misterios</h2>
                <div class="cards-grid symmetric">
                    <div class="card fade-in">
                        <h3>🌍 Caso Origen</h3>
                        <p>¿De qué región de Costa Rica viene este café? ¿Qué finca? Descifra las pistas en cada sorbo.</p>
                    </div>
                    <div class="card fade-in">
                        <h3>⚙️ Caso Proceso</h3>
                        <p>¿Lavado, natural, honey? El proceso de beneficiado deja huellas únicas.</p>
                    </div>
                    <div class="card fade-in">
                        <h3>🌱 Caso Variedad</h3>
                        <p>¿Caturra, Bourbon, Geisha? Cada variedad tiene su personalidad única.</p>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Order Page -->
    <div id="order" class="page">
        <section class="section">
            <div class="container">
                <h2 class="section-title">Ordenar Caja Detective</h2>
                <div class="form-container">
                    <h3 style="color: #d4af37; text-align: center; margin-bottom: 1rem;">💰 Precio: ₡18,000</h3>
                    <p style="text-align: center; margin-bottom: 2rem; opacity: 0.9;">
                        Incluye 4 cafés costarricenses misteriosos de 80g cada uno + guía de cata + acceso al juego online
                    </p>
                    <div style="text-align: center;">
                        <a href="https://wa.me/50612345678?text=Hola!%20Quiero%20ordenar%20una%20caja%20Brew%20Detective%20por%20₡18,000" 
                           class="cta-button" 
                           target="_blank" 
                           rel="noopener noreferrer">
                            📱 Ordenar por WhatsApp
                        </a>
                    </div>
                    <p style="text-align: center; margin-top: 1rem; opacity: 0.7; font-size: 0.9rem;">
                        Te contactaremos para coordinar la entrega y el pago
                    </p>
                </div>
            </div>
        </section>
    </div>

    <!-- Submit Page -->
    <div id="submit" class="page">
        <section class="section">
            <div class="container">
                <h2 class="section-title">Enviar Respuestas del Caso</h2>
                
                <!-- Scoring Information Box -->
                <div id="scoringInfoBox" style="background: linear-gradient(135deg, rgba(212, 175, 55, 0.15), rgba(212, 175, 55, 0.05)); border: 1px solid rgba(212, 175, 55, 0.3); border-radius: 12px; padding: 1.5rem; margin-bottom: 2rem;">
                    <h3 style="color: #d4af37; margin: 0 0 1rem 0; display: flex; align-items: center; gap: 0.5rem;">
                        <span style="font-size: 1.2rem;">🎯</span>
                        Scoring System
                    </h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-bottom: 1rem;">
                        <div>
                            <h4 style="color: #d4af37; margin: 0 0 0.5rem 0; font-size: 0.95rem;">📊 Points per Coffee</h4>
                            <div id="coffeeQuestionsList" style="font-size: 0.9rem; line-height: 1.4;">
                                <div style="opacity: 0.7; font-style: italic;">Loading case questions...</div>
                            </div>
                        </div>
                        <div>
                            <h4 style="color: #d4af37; margin: 0 0 0.5rem 0; font-size: 0.95rem;">⭐ Bonus Points</h4>
                            <div id="bonusQuestionsList" style="font-size: 0.9rem; line-height: 1.4;">
                                <div style="opacity: 0.7; font-style: italic;">Loading bonus questions...</div>
                            </div>
                            <div id="maxScoreDisplay" style="margin-top: 0.8rem; padding: 0.5rem; background: rgba(212, 175, 55, 0.1); border-radius: 6px; text-align: center;">
                                <strong style="color: #d4af37; font-size: 1rem;">🏆 Maximum: -- points</strong>
                            </div>
                        </div>
                    </div>
                    <div style="background: rgba(212, 175, 55, 0.08); padding: 0.8rem; border-radius: 8px; border-left: 4px solid #d4af37;">
                        <p style="margin: 0; font-size: 0.9rem; opacity: 0.9;">
                            <strong>💡 Tip:</strong> Scoring adapts automatically based on enabled questions for this case. 
                            Each correct answer contributes to your overall accuracy!
                        </p>
                    </div>
                </div>
                
                <div class="form-container">
                    <div class="success-message" id="submitSuccess">
                        ¡Caso resuelto exitosamente! Tus respuestas han sido enviadas.
                    </div>
                    <div class="error-message" id="submitError">
                        Error al enviar respuestas. Por favor intenta nuevamente.
                    </div>
                    <div class="form-group">
                        <label>Caso Activo:</label>
                        <div id="activeCaseDisplay" style="background: rgba(212, 175, 55, 0.1); padding: 1rem; border-radius: 8px; border: 1px solid rgba(212, 175, 55, 0.3); margin-bottom: 1rem;">
                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                <span style="font-size: 1.2rem;">📦</span>
                                <span id="activeCaseName" style="font-weight: bold; color: #d4af37;">Cargando caso activo...</span>
                            </div>
                            <div id="activeCaseDescription" style="margin-top: 0.5rem; opacity: 0.8; font-size: 0.9rem;"></div>
                        </div>
                    </div>
                    
                    <form id="submitForm">
                        <div class="form-group">
                            <label for="orderId">ID de Orden (6 caracteres):</label>
                            <input type="text" id="orderId" placeholder="Ej: ABC123" maxlength="6" required style="text-transform: uppercase;">
                            <small style="color: rgba(244, 241, 232, 0.7); font-size: 0.9rem; margin-top: 0.5rem; display: block;">
                                Este código fue enviado con tu orden de café. Es necesario para validar tu compra.
                            </small>
                        </div>
                        
                        <h3 style="color: #d4af37; margin: 2rem 0 1rem 0;">☕ Café #1</h3>
                        <div class="form-group">
                            <label for="coffee1_region">Región de Costa Rica:</label>
                            <select id="coffee1_region" required>
                                <option value="">Selecciona una región</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="coffee1_variety">Variedad:</label>
                            <select id="coffee1_variety" required>
                                <option value="">Selecciona una variedad</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="coffee1_process">Proceso de Beneficiado:</label>
                            <select id="coffee1_process" required>
                                <option value="">Selecciona un proceso</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="coffee1_note1">Primera Nota de Sabor:</label>
                            <input type="text" id="coffee1_note1" placeholder="Ej: Chocolate, Frutal, Floral, Nuez..." maxlength="50">
                        </div>
                        <div class="form-group">
                            <label for="coffee1_note2">Segunda Nota de Sabor:</label>
                            <input type="text" id="coffee1_note2" placeholder="Ej: Cítrico, Caramelo, Especias, Miel..." maxlength="50">
                        </div>

                        <h3 style="color: #d4af37; margin: 2rem 0 1rem 0;">☕ Café #2</h3>
                        <div class="form-group">
                            <label for="coffee2_region">Región de Costa Rica:</label>
                            <select id="coffee2_region" required>
                                <option value="">Selecciona una región</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="coffee2_variety">Variedad:</label>
                            <select id="coffee2_variety" required>
                                <option value="">Selecciona una variedad</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="coffee2_process">Proceso de Beneficiado:</label>
                            <select id="coffee2_process" required>
                                <option value="">Selecciona un proceso</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="coffee2_note1">Primera Nota de Sabor:</label>
                            <input type="text" id="coffee2_note1" placeholder="Ej: Chocolate, Frutal, Floral, Nuez..." maxlength="50">
                        </div>
                        <div class="form-group">
                            <label for="coffee2_note2">Segunda Nota de Sabor:</label>
                            <input type="text" id="coffee2_note2" placeholder="Ej: Cítrico, Caramelo, Especias, Miel..." maxlength="50">
                        </div>

                        <h3 style="color: #d4af37; margin: 2rem 0 1rem 0;">☕ Café #3</h3>
                        <div class="form-group">
                            <label for="coffee3_region">Región de Costa Rica:</label>
                            <select id="coffee3_region" required>
                                <option value="">Selecciona una región</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="coffee3_variety">Variedad:</label>
                            <select id="coffee3_variety" required>
                                <option value="">Selecciona una variedad</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="coffee3_process">Proceso de Beneficiado:</label>
                            <select id="coffee3_process" required>
                                <option value="">Selecciona un proceso</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="coffee3_note1">Primera Nota de Sabor:</label>
                            <input type="text" id="coffee3_note1" placeholder="Ej: Chocolate, Frutal, Floral, Nuez..." maxlength="50">
                        </div>
                        <div class="form-group">
                            <label for="coffee3_note2">Segunda Nota de Sabor:</label>
                            <input type="text" id="coffee3_note2" placeholder="Ej: Cítrico, Caramelo, Especias, Miel..." maxlength="50">
                        </div>

                        <h3 style="color: #d4af37; margin: 2rem 0 1rem 0;">☕ Café #4</h3>
                        <div class="form-group">
                            <label for="coffee4_region">Región de Costa Rica:</label>
                            <select id="coffee4_region" required>
                                <option value="">Selecciona una región</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="coffee4_variety">Variedad:</label>
                            <select id="coffee4_variety" required>
                                <option value="">Selecciona una variedad</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="coffee4_process">Proceso de Beneficiado:</label>
                            <select id="coffee4_process" required>
                                <option value="">Selecciona un proceso</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="coffee4_note1">Primera Nota de Sabor:</label>
                            <input type="text" id="coffee4_note1" placeholder="Ej: Chocolate, Frutal, Floral, Nuez..." maxlength="50">
                        </div>
                        <div class="form-group">
                            <label for="coffee4_note2">Segunda Nota de Sabor:</label>
                            <input type="text" id="coffee4_note2" placeholder="Ej: Cítrico, Caramelo, Especias, Miel..." maxlength="50">
                        </div>

                        <h3 style="color: #d4af37; margin: 2rem 0 1rem 0;">🔍 Preguntas Bonus</h3>
                        <div class="form-group">
                            <label for="favorite_coffee">¿Cuál fue tu café favorito y por qué?</label>
                            <textarea id="favorite_coffee" rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="brewing_method">¿En qué método de preparación lo disfrutaste más?</label>
                            <select id="brewing_method">
                                <option value="">Selecciona un método</option>
                            </select>
                        </div>

                        <button type="submit" class="cta-button">Enviar Solución del Caso</button>
                    </form>
                </div>
            </div>
        </section>
    </div>

    <!-- Leaderboard Page -->
    <div id="leaderboard" class="page">
        <section class="section">
            <div class="container">
                <h2 class="section-title">Ranking de Detectives</h2>
                <div class="leaderboard">
                    <!-- Leaderboard entries will be loaded dynamically from API -->
                </div>
                <div style="text-align: center; margin-top: 2rem;">
                    <p style="color: #d4af37; font-size: 1.1rem;">🏆 Próxima actualización: en 2 días</p>
                    <p style="margin-top: 1rem; opacity: 0.8;">El ranking se actualiza cada domingo con los nuevos casos resueltos</p>
                </div>
            </div>
        </section>
    </div>

    <!-- Profile Page -->
    <div id="profile" class="page">
        <section class="section">
            <div class="container">
                <h2 class="section-title">Mi Perfil de Detective</h2>
                <div class="cards-grid">
                    <div class="card">
                        <h3>👤 Información Personal</h3>
                        <div class="form-container" style="background: transparent; border: none; padding: 0;">
                            <div class="form-group">
                                <label for="profileName">Nombre del Detective:</label>
                                <input type="text" id="profileName" placeholder="Ingresa tu nombre">
                            </div>
                            <div class="form-group">
                                <label for="profileEmail">Email:</label>
                                <input type="email" id="profileEmail" placeholder="tu@email.com">
                            </div>
                            <div class="form-group">
                                <label for="profileLevel">Nivel de Experiencia:</label>
                                <select id="profileLevel">
                                    <option value="beginner">Principiante</option>
                                    <option value="intermediate">Intermedio</option>
                                    <option value="expert">Experto</option>
                                </select>
                            </div>
                            <button type="button" class="cta-button" onclick="saveProfile()">Actualizar Perfil</button>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h3>📊 Mis Estadísticas</h3>
                        <div style="text-align: center;">
                            <div style="margin: 1rem 0;">
                                <div style="font-size: 2rem; color: #d4af37; font-weight: bold;" data-stat="points">0</div>
                                <div>Puntos Totales</div>
                            </div>
                            <div style="margin: 1rem 0;">
                                <div style="font-size: 1.5rem; color: #d4af37; font-weight: bold;" data-stat="rank"># --</div>
                                <div>Posición en el Ranking</div>
                            </div>
                            <div style="margin: 1rem 0;">
                                <div style="font-size: 1.5rem; color: #d4af37; font-weight: bold;" data-stat="cases">0</div>
                                <div>Casos Resueltos</div>
                            </div>
                            <div style="margin: 1rem 0;">
                                <div style="font-size: 1.5rem; color: #d4af37; font-weight: bold;" data-stat="accuracy">0%</div>
                                <div>Precisión</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card" style="margin-top: 2rem;">
                    <h3>🏅 Mis Insignias</h3>
                    <div style="text-align: center; margin: 1rem 0;">
                        <span class="badge">🔍 Primer Caso</span>
                        <span class="badge">🌍 Experto en Orígenes</span>
                        <span class="badge">☕ Catador Nivel 1</span>
                        <span class="badge">🎯 Precisión 70%</span>
                    </div>
                    <div style="margin-top: 1rem; opacity: 0.8; text-align: center;">
                        <p>Próximas insignias por desbloquear:</p>
                        <div style="margin: 0.5rem 0;">
                            <span style="opacity: 0.5;">🏆 Detective Maestro (necesitas 2,000 pts)</span><br>
                            <span style="opacity: 0.5;">🔥 Experto en Tuestes (necesitas 5 casos)</span><br>
                            <span style="opacity: 0.5;">💎 Catador Nivel 2 (necesitas 80% precisión)</span>
                        </div>
                    </div>
                </div>

                <div class="card" style="margin-top: 2rem;">
                    <h3>📋 Historial de Casos</h3>
                    <div id="caseHistoryContainer" style="margin: 1rem 0;">
                        <div style="text-align: center; opacity: 0.7;">
                            <p>Cargando historial de casos...</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Admin Page -->
    <div id="admin" class="page">
        <section class="section">
            <div class="container">
                <h2 class="section-title">Panel de Administración</h2>
                
                <!-- Case Management -->
                <div class="card">
                    <h3>📦 Gestión de Casos</h3>
                    
                    <!-- Case Creation Form -->
                    <div id="caseManagementSection">
                        <div class="form-group">
                            <button type="button" onclick="showCreateCaseForm()" class="cta-button" style="position: relative; z-index: 10; pointer-events: auto;">Crear Nuevo Caso</button>
                            <button type="button" onclick="loadAllCases()" class="cta-button" style="background: #666; margin-left: 1rem; position: relative; z-index: 10; pointer-events: auto;">Ver Todos los Casos</button>
                        </div>

                        <!-- Create Case Form -->
                        <div id="createCaseForm" style="display: none; background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 8px; margin: 1rem 0; position: relative; z-index: 10;">
                            <h4>Crear Nuevo Caso</h4>
                            <div class="form-group">
                                <label for="caseName">Nombre del Caso:</label>
                                <input type="text" id="caseName" placeholder="ej: Misterio del Valle Central" style="position: relative; z-index: 15; pointer-events: auto;">
                            </div>
                            <div class="form-group">
                                <label for="caseDescription">Descripción:</label>
                                <textarea id="caseDescription" rows="3" placeholder="Descripción del caso de café..." style="position: relative; z-index: 15; pointer-events: auto;"></textarea>
                            </div>

                            <!-- Coffee 1 -->
                            <h5 style="color: #d4af37; margin: 1rem 0 0.5rem 0;">☕ Café #1</h5>
                            <div class="form-group">
                                <label for="coffee1Name">Nombre del Café:</label>
                                <input type="text" id="coffee1Name" placeholder="ej: Finca La Esperanza" style="position: relative; z-index: 15; pointer-events: auto;">
                            </div>
                            <div class="form-group">
                                <label for="coffee1Region">Región:</label>
                                <select id="coffee1Region" style="position: relative; z-index: 15; pointer-events: auto;">
                                    <option value="">Selecciona una región</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="coffee1Variety">Variedad:</label>
                                <select id="coffee1Variety" style="position: relative; z-index: 15; pointer-events: auto;">
                                    <option value="">Selecciona una variedad</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="coffee1Process">Proceso:</label>
                                <select id="coffee1Process" style="position: relative; z-index: 15; pointer-events: auto;">
                                    <option value="">Selecciona un proceso</option>
                                </select>
                            </div>

                            <!-- Coffee 2 -->
                            <h5 style="color: #d4af37; margin: 1rem 0 0.5rem 0;">☕ Café #2</h5>
                            <div class="form-group">
                                <label for="coffee2Name">Nombre del Café:</label>
                                <input type="text" id="coffee2Name" placeholder="ej: Finca El Mirador" style="position: relative; z-index: 15; pointer-events: auto;">
                            </div>
                            <div class="form-group">
                                <label for="coffee2Region">Región:</label>
                                <select id="coffee2Region" style="position: relative; z-index: 15; pointer-events: auto;">
                                    <option value="">Selecciona una región</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="coffee2Variety">Variedad:</label>
                                <select id="coffee2Variety" style="position: relative; z-index: 15; pointer-events: auto;">
                                    <option value="">Selecciona una variedad</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="coffee2Process">Proceso:</label>
                                <select id="coffee2Process" style="position: relative; z-index: 15; pointer-events: auto;">
                                    <option value="">Selecciona un proceso</option>
                                </select>
                            </div>

                            <!-- Coffee 3 -->
                            <h5 style="color: #d4af37; margin: 1rem 0 0.5rem 0;">☕ Café #3</h5>
                            <div class="form-group">
                                <label for="coffee3Name">Nombre del Café:</label>
                                <input type="text" id="coffee3Name" placeholder="ej: Finca Las Nubes" style="position: relative; z-index: 15; pointer-events: auto;">
                            </div>
                            <div class="form-group">
                                <label for="coffee3Region">Región:</label>
                                <select id="coffee3Region" style="position: relative; z-index: 15; pointer-events: auto;">
                                    <option value="">Selecciona una región</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="coffee3Variety">Variedad:</label>
                                <select id="coffee3Variety" style="position: relative; z-index: 15; pointer-events: auto;">
                                    <option value="">Selecciona una variedad</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="coffee3Process">Proceso:</label>
                                <select id="coffee3Process" style="position: relative; z-index: 15; pointer-events: auto;">
                                    <option value="">Selecciona un proceso</option>
                                </select>
                            </div>

                            <!-- Coffee 4 -->
                            <h5 style="color: #d4af37; margin: 1rem 0 0.5rem 0;">☕ Café #4</h5>
                            <div class="form-group">
                                <label for="coffee4Name">Nombre del Café:</label>
                                <input type="text" id="coffee4Name" placeholder="ej: Finca El Volcán" style="position: relative; z-index: 15; pointer-events: auto;">
                            </div>
                            <div class="form-group">
                                <label for="coffee4Region">Región:</label>
                                <select id="coffee4Region" style="position: relative; z-index: 15; pointer-events: auto;">
                                    <option value="">Selecciona una región</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="coffee4Variety">Variedad:</label>
                                <select id="coffee4Variety" style="position: relative; z-index: 15; pointer-events: auto;">
                                    <option value="">Selecciona una variedad</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="coffee4Process">Proceso:</label>
                                <select id="coffee4Process" style="position: relative; z-index: 15; pointer-events: auto;">
                                    <option value="">Selecciona un proceso</option>
                                </select>
                            </div>

                            <!-- Question Configuration -->
                            <h5 style="color: #d4af37; margin: 1rem 0 0.5rem 0;">❓ Configuración de Preguntas</h5>
                            <p style="opacity: 0.8; font-size: 0.9rem; margin-bottom: 1rem;">Selecciona qué preguntas hacer a los usuarios durante la evaluación:</p>
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.5rem; margin-bottom: 1rem;">
                                <label style="display: flex; align-items: center; gap: 0.5rem; background: rgba(212, 175, 55, 0.1); padding: 0.5rem; border-radius: 4px;">
                                    <input type="checkbox" id="questionRegion" checked style="position: relative; z-index: 15; pointer-events: auto;">
                                    <span>Región</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 0.5rem; background: rgba(212, 175, 55, 0.1); padding: 0.5rem; border-radius: 4px;">
                                    <input type="checkbox" id="questionVariety" checked style="position: relative; z-index: 15; pointer-events: auto;">
                                    <span>Variedad</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 0.5rem; background: rgba(212, 175, 55, 0.1); padding: 0.5rem; border-radius: 4px;">
                                    <input type="checkbox" id="questionProcess" checked style="position: relative; z-index: 15; pointer-events: auto;">
                                    <span>Proceso</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 0.5rem; background: rgba(212, 175, 55, 0.1); padding: 0.5rem; border-radius: 4px;">
                                    <input type="checkbox" id="questionTasteNote1" checked style="position: relative; z-index: 15; pointer-events: auto;">
                                    <span>Primera Nota de Sabor</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 0.5rem; background: rgba(212, 175, 55, 0.1); padding: 0.5rem; border-radius: 4px;">
                                    <input type="checkbox" id="questionTasteNote2" checked style="position: relative; z-index: 15; pointer-events: auto;">
                                    <span>Segunda Nota de Sabor</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 0.5rem; background: rgba(212, 175, 55, 0.1); padding: 0.5rem; border-radius: 4px;">
                                    <input type="checkbox" id="questionFavoriteCoffee" checked style="position: relative; z-index: 15; pointer-events: auto;">
                                    <span>Café Favorito</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 0.5rem; background: rgba(212, 175, 55, 0.1); padding: 0.5rem; border-radius: 4px;">
                                    <input type="checkbox" id="questionBrewingMethod" checked style="position: relative; z-index: 15; pointer-events: auto;">
                                    <span>Método de Preparación</span>
                                </label>
                            </div>

                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="caseIsActive" style="position: relative; z-index: 15; pointer-events: auto;"> Activar caso inmediatamente
                                </label>
                            </div>

                            <button type="button" onclick="createCase()" class="cta-button" style="margin-right: 1rem; position: relative; z-index: 15; pointer-events: auto;">Crear Caso</button>
                            <button type="button" onclick="cancelCreateCase()" class="cta-button" style="background: #666; position: relative; z-index: 15; pointer-events: auto;">Cancelar</button>
                        </div>

                        <!-- Edit Case Form -->
                        <div id="editCaseForm" style="display: none; background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 8px; margin: 1rem 0; position: relative; z-index: 10;">
                            <h4>Editar Caso</h4>
                            <input type="hidden" id="editCaseId">
                            <div class="form-group">
                                <label for="editCaseName">Nombre del Caso:</label>
                                <input type="text" id="editCaseName" placeholder="ej: Misterio del Valle Central" style="position: relative; z-index: 15; pointer-events: auto;">
                            </div>
                            <div class="form-group">
                                <label for="editCaseDescription">Descripción:</label>
                                <textarea id="editCaseDescription" rows="3" placeholder="Descripción del caso de café..." style="position: relative; z-index: 15; pointer-events: auto;"></textarea>
                            </div>

                            <!-- Coffee 1 -->
                            <h5 style="color: #d4af37; margin: 1rem 0 0.5rem 0;">☕ Café #1</h5>
                            <div class="form-group">
                                <label for="editCoffee1Name">Nombre del Café:</label>
                                <input type="text" id="editCoffee1Name" placeholder="ej: Finca La Esperanza" style="position: relative; z-index: 15; pointer-events: auto;">
                            </div>
                            <div class="form-group">
                                <label for="editCoffee1Region">Región:</label>
                                <select id="editCoffee1Region" style="position: relative; z-index: 15; pointer-events: auto;">
                                    <option value="">Selecciona una región</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="editCoffee1Variety">Variedad:</label>
                                <select id="editCoffee1Variety" style="position: relative; z-index: 15; pointer-events: auto;">
                                    <option value="">Selecciona una variedad</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="editCoffee1Process">Proceso:</label>
                                <select id="editCoffee1Process" style="position: relative; z-index: 15; pointer-events: auto;">
                                    <option value="">Selecciona un proceso</option>
                                </select>
                            </div>

                            <!-- Coffee 2 -->
                            <h5 style="color: #d4af37; margin: 1rem 0 0.5rem 0;">☕ Café #2</h5>
                            <div class="form-group">
                                <label for="editCoffee2Name">Nombre del Café:</label>
                                <input type="text" id="editCoffee2Name" placeholder="ej: Finca El Mirador" style="position: relative; z-index: 15; pointer-events: auto;">
                            </div>
                            <div class="form-group">
                                <label for="editCoffee2Region">Región:</label>
                                <select id="editCoffee2Region" style="position: relative; z-index: 15; pointer-events: auto;">
                                    <option value="">Selecciona una región</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="editCoffee2Variety">Variedad:</label>
                                <select id="editCoffee2Variety" style="position: relative; z-index: 15; pointer-events: auto;">
                                    <option value="">Selecciona una variedad</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="editCoffee2Process">Proceso:</label>
                                <select id="editCoffee2Process" style="position: relative; z-index: 15; pointer-events: auto;">
                                    <option value="">Selecciona un proceso</option>
                                </select>
                            </div>

                            <!-- Coffee 3 -->
                            <h5 style="color: #d4af37; margin: 1rem 0 0.5rem 0;">☕ Café #3</h5>
                            <div class="form-group">
                                <label for="editCoffee3Name">Nombre del Café:</label>
                                <input type="text" id="editCoffee3Name" placeholder="ej: Finca Las Nubes" style="position: relative; z-index: 15; pointer-events: auto;">
                            </div>
                            <div class="form-group">
                                <label for="editCoffee3Region">Región:</label>
                                <select id="editCoffee3Region" style="position: relative; z-index: 15; pointer-events: auto;">
                                    <option value="">Selecciona una región</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="editCoffee3Variety">Variedad:</label>
                                <select id="editCoffee3Variety" style="position: relative; z-index: 15; pointer-events: auto;">
                                    <option value="">Selecciona una variedad</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="editCoffee3Process">Proceso:</label>
                                <select id="editCoffee3Process" style="position: relative; z-index: 15; pointer-events: auto;">
                                    <option value="">Selecciona un proceso</option>
                                </select>
                            </div>

                            <!-- Coffee 4 -->
                            <h5 style="color: #d4af37; margin: 1rem 0 0.5rem 0;">☕ Café #4</h5>
                            <div class="form-group">
                                <label for="editCoffee4Name">Nombre del Café:</label>
                                <input type="text" id="editCoffee4Name" placeholder="ej: Finca El Volcán" style="position: relative; z-index: 15; pointer-events: auto;">
                            </div>
                            <div class="form-group">
                                <label for="editCoffee4Region">Región:</label>
                                <select id="editCoffee4Region" style="position: relative; z-index: 15; pointer-events: auto;">
                                    <option value="">Selecciona una región</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="editCoffee4Variety">Variedad:</label>
                                <select id="editCoffee4Variety" style="position: relative; z-index: 15; pointer-events: auto;">
                                    <option value="">Selecciona una variedad</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="editCoffee4Process">Proceso:</label>
                                <select id="editCoffee4Process" style="position: relative; z-index: 15; pointer-events: auto;">
                                    <option value="">Selecciona un proceso</option>
                                </select>
                            </div>

                            <!-- Question Configuration -->
                            <h5 style="color: #d4af37; margin: 1rem 0 0.5rem 0;">❓ Configuración de Preguntas</h5>
                            <p style="opacity: 0.8; font-size: 0.9rem; margin-bottom: 1rem;">Selecciona qué preguntas hacer a los usuarios durante la evaluación:</p>
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.5rem; margin-bottom: 1rem;">
                                <label style="display: flex; align-items: center; gap: 0.5rem; background: rgba(212, 175, 55, 0.1); padding: 0.5rem; border-radius: 4px;">
                                    <input type="checkbox" id="editQuestionRegion" style="position: relative; z-index: 15; pointer-events: auto;">
                                    <span>Región</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 0.5rem; background: rgba(212, 175, 55, 0.1); padding: 0.5rem; border-radius: 4px;">
                                    <input type="checkbox" id="editQuestionVariety" style="position: relative; z-index: 15; pointer-events: auto;">
                                    <span>Variedad</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 0.5rem; background: rgba(212, 175, 55, 0.1); padding: 0.5rem; border-radius: 4px;">
                                    <input type="checkbox" id="editQuestionProcess" style="position: relative; z-index: 15; pointer-events: auto;">
                                    <span>Proceso</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 0.5rem; background: rgba(212, 175, 55, 0.1); padding: 0.5rem; border-radius: 4px;">
                                    <input type="checkbox" id="editQuestionTasteNote1" style="position: relative; z-index: 15; pointer-events: auto;">
                                    <span>Primera Nota de Sabor</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 0.5rem; background: rgba(212, 175, 55, 0.1); padding: 0.5rem; border-radius: 4px;">
                                    <input type="checkbox" id="editQuestionTasteNote2" style="position: relative; z-index: 15; pointer-events: auto;">
                                    <span>Segunda Nota de Sabor</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 0.5rem; background: rgba(212, 175, 55, 0.1); padding: 0.5rem; border-radius: 4px;">
                                    <input type="checkbox" id="editQuestionFavoriteCoffee" style="position: relative; z-index: 15; pointer-events: auto;">
                                    <span>Café Favorito</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 0.5rem; background: rgba(212, 175, 55, 0.1); padding: 0.5rem; border-radius: 4px;">
                                    <input type="checkbox" id="editQuestionBrewingMethod" style="position: relative; z-index: 15; pointer-events: auto;">
                                    <span>Método de Preparación</span>
                                </label>
                            </div>

                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="editCaseIsActive" style="position: relative; z-index: 15; pointer-events: auto;"> Caso activo
                                </label>
                            </div>

                            <button type="button" onclick="updateCase()" class="cta-button" style="margin-right: 1rem; position: relative; z-index: 15; pointer-events: auto;">Actualizar Caso</button>
                            <button type="button" onclick="cancelEditCase()" class="cta-button" style="background: #666; position: relative; z-index: 15; pointer-events: auto;">Cancelar</button>
                        </div>

                        <!-- Cases List -->
                        <div id="casesList" style="margin-top: 2rem;">
                            <!-- Cases will be loaded here -->
                        </div>
                    </div>
                </div>

                <!-- Order Management -->
                <div class="card">
                    <h3>📋 Gestión de Órdenes</h3>
                    
                    <!-- Order Creation Form -->
                    <div id="orderManagementSection">
                        <div class="form-group">
                            <button type="button" onclick="showCreateOrderForm()" class="cta-button" style="position: relative; z-index: 10; pointer-events: auto;">Crear Nueva Orden</button>
                            <button type="button" onclick="loadAllOrders()" class="cta-button" style="background: #666; margin-left: 1rem; position: relative; z-index: 10; pointer-events: auto;">Ver Todas las Órdenes</button>
                        </div>

                        <!-- Create Order Form -->
                        <div id="createOrderForm" style="display: none; background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 8px; margin: 1rem 0; position: relative; z-index: 10;">
                            <h4>Crear Nueva Orden</h4>
                            <div class="form-group">
                                <label for="orderUserSelect">Usuario:</label>
                                <select id="orderUserSelect" required style="position: relative; z-index: 15; pointer-events: auto;">
                                    <option value="">Selecciona un usuario</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="orderCaseSelect">Caso:</label>
                                <select id="orderCaseSelect" required style="position: relative; z-index: 15; pointer-events: auto;">
                                    <option value="">Selecciona un caso</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="orderContactInfo">Información de Contacto:</label>
                                <textarea id="orderContactInfo" rows="3" placeholder="Teléfono, WhatsApp, dirección, etc." style="position: relative; z-index: 15; pointer-events: auto;"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="orderAmount">Monto Total (₡):</label>
                                <input type="number" id="orderAmount" placeholder="18000" min="0" style="position: relative; z-index: 15; pointer-events: auto;">
                            </div>
                            <div class="form-group">
                                <label for="orderStatus">Estado:</label>
                                <select id="orderStatus" style="position: relative; z-index: 15; pointer-events: auto;">
                                    <option value="pending">Pendiente</option>
                                    <option value="confirmed">Confirmada</option>
                                    <option value="shipped">Enviada</option>
                                    <option value="delivered">Entregada</option>
                                </select>
                            </div>

                            <button type="button" onclick="createOrder()" class="cta-button" style="margin-right: 1rem; position: relative; z-index: 15; pointer-events: auto;">Crear Orden</button>
                            <button type="button" onclick="cancelCreateOrder()" class="cta-button" style="background: #666; position: relative; z-index: 15; pointer-events: auto;">Cancelar</button>
                        </div>

                        <!-- Orders List -->
                        <div id="ordersList" style="margin-top: 2rem;">
                            <!-- Orders will be loaded here -->
                        </div>
                    </div>
                </div>

                <!-- Catalog Management -->
                <div class="card">
                    <h3>🗂️ Gestión de Catálogos</h3>
                    
                    <!-- Category Selector -->
                    <div class="form-group">
                        <label for="adminCategorySelect">Categoría:</label>
                        <select id="adminCategorySelect" onchange="loadCatalogItems()" style="position: relative; z-index: 10; pointer-events: auto;">
                            <option value="">Selecciona una categoría</option>
                            <option value="region">Regiones</option>
                            <option value="variety">Variedades</option>
                            <option value="process">Procesos de Beneficiado</option>
                            <option value="brewing_method">Métodos de Preparación</option>
                        </select>
                    </div>

                    <!-- Add New Item Form -->
                    <div id="addItemForm" style="display: none; background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 8px; margin: 1rem 0; position: relative; z-index: 10;">
                        <h4>Agregar Nuevo Item</h4>
                        <div class="form-group">
                            <label for="newItemValue">Valor (ID interno):</label>
                            <input type="text" id="newItemValue" placeholder="ej: central_valley" style="position: relative; z-index: 15; pointer-events: auto;">
                        </div>
                        <div class="form-group">
                            <label for="newItemLabel">Etiqueta (Nombre mostrado):</label>
                            <input type="text" id="newItemLabel" placeholder="ej: Valle Central" style="position: relative; z-index: 15; pointer-events: auto;">
                        </div>
                        <div class="form-group">
                            <label for="newItemOrder">Orden de Visualización:</label>
                            <input type="number" id="newItemOrder" value="0" min="0" style="position: relative; z-index: 15; pointer-events: auto;">
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="newItemActive" checked style="position: relative; z-index: 15; pointer-events: auto;"> Activo
                            </label>
                        </div>
                        <button type="button" onclick="createCatalogItem()" class="cta-button" style="margin-right: 1rem; position: relative; z-index: 15; pointer-events: auto;">Crear Item</button>
                        <button type="button" onclick="cancelAddItem()" class="cta-button" style="background: #666; position: relative; z-index: 15; pointer-events: auto;">Cancelar</button>
                    </div>

                    <!-- Actions -->
                    <div style="margin: 1rem 0; position: relative; z-index: 5;">
                        <button type="button" onclick="showAddItemForm()" class="cta-button" id="addItemBtn" style="display: none; position: relative; z-index: 10; pointer-events: auto;">Agregar Nuevo Item</button>
                        <button type="button" onclick="loadCatalogItems()" class="cta-button" style="background: #666; margin-left: 1rem; position: relative; z-index: 10; pointer-events: auto; display: none;" id="refreshBtn">Actualizar Lista</button>
                    </div>

                    <!-- Catalog Items List -->
                    <div id="catalogItemsList" style="margin-top: 2rem;">
                        <!-- Items will be loaded here -->
                    </div>
                </div>

                <!-- Success/Error Messages -->
                <div id="adminSuccess" class="success-message" style="margin-top: 1rem;">
                    Operación completada exitosamente
                </div>
                <div id="adminError" class="error-message" style="margin-top: 1rem;">
                    Error en la operación
                </div>
            </div>
        </section>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">🔍 Brew Detective</div>
                <div class="footer-divider"></div>
                <div style="display: flex; align-items: center; gap: 0.5rem;">
                    <span>Una experiencia creada por</span>
                    <a href="https://instagram.com/sinfonia_cafe_cr" class="footer-brand" target="_blank" rel="noopener noreferrer">
                        <img src="images/sinfonia-logo.png" alt="Sinfonía Café" class="footer-profile-pic">
                        <strong>Sinfonía Café</strong>
                    </a>
                </div>
            </div>
            <div class="footer-text">
                <p>© 2025 Brew Detective. Todos los derechos reservados.</p>
                <p>Síguenos en <a href="https://instagram.com/sinfonia_cafe_cr" style="color: #d4af37; text-decoration: none;" target="_blank" rel="noopener noreferrer">@sinfonia_cafe_cr</a></p>
            </div>
        </div>
    </footer>

    <script src="js/config.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/main.js"></script>
</body>
</html>